KorAP deployment complete.

Kalamar:
  Service: {{ include "korap.fullname" . }}-kalamar
  Port: {{ ((.Values.service | default dict).kalamar | default dict).port }}

Kustvakt:
  Service: {{ include "korap.fullname" . }}-kustvakt
  Port: {{ ((.Values.service | default dict).kustvakt | default dict).port }}

Profile: {{ if (.Values.full | default dict).enabled }}full{{ else }}lite{{ end }}

Index Volume:
{{- if (.Values.indexVolume | default dict).existingClaim }}
  Using existing PVC: {{ (.Values.indexVolume | default dict).existingClaim }}
{{- else }}
  Created PVC: {{ include "korap.fullname" . }}-index
{{- end }}

{{ if and (.Values.full | default dict).enabled (.Values.kalamarFull | default dict).enabled }}
AUTHENTICATION STATUS:
{{- $secretName := (.Values.full | default dict).superClientInfoSecretName }}
{{- if not $secretName }}
{{- if and (.Values.full | default dict).enabled ((.Values.full | default dict).superClientInfo | default dict).enabled }}
{{- $secretName = printf "%s-super-client-info" (include "korap.fullname" .) }}
  ✅ OAuth ENABLED (Auto-Generated)
  Secret: {{ $secretName }}
  
  View generated OAuth credentials:
  kubectl get secret {{ $secretName }} -o jsonpath='{.data.super_client_info}' -n {{ .Release.Namespace }} | base64 -d
  
  Edit/update OAuth configuration:
  kubectl edit secret {{ $secretName }} -n {{ .Release.Namespace }}
  Then restart Kalamar: kubectl rollout restart deployment/{{ include "korap.fullname" . }}-kalamar-full -n {{ .Release.Namespace }}
{{- else }}
  ⚠️  Auth DISABLED
  To enable OAuth authentication, update the deployment:
  
  helm upgrade {{ .Release.Name }} ./korap \
    --set 'full.superClientInfo.enabled=true' \
    -n {{ .Release.Namespace }}
{{- end }}
{{- else }}
  ✅ OAuth ENABLED
  Secret: {{ $secretName }} (External)
  
  To update OAuth configuration, edit the secret:
  kubectl edit secret {{ $secretName }} -n {{ .Release.Namespace }}
  Then restart Kalamar: kubectl rollout restart deployment/{{ include "korap.fullname" . }}-kalamar-full -n {{ .Release.Namespace }}
{{- end }}

{{- end }}

NEXT STEPS:

1. Access Kalamar:
   kubectl port-forward svc/{{ include "korap.fullname" . }}-kalamar {{ ((.Values.service | default dict).kalamar | default dict).port }}:{{ ((.Values.service | default dict).kalamar | default dict).port }} -n {{ .Release.Namespace }}
   Then open: http://localhost:{{ ((.Values.service | default dict).kalamar | default dict).port }}

2. Check deployment status:
   kubectl get pods -n {{ .Release.Namespace }}

3. View logs:
   kubectl logs deployment/{{ include "korap.fullname" . }}-kalamar -n {{ .Release.Namespace }}
   {{ if (.Values.full | default dict).enabled }}kubectl logs deployment/{{ include "korap.fullname" . }}-kalamar-full -n {{ .Release.Namespace }}{{- end }}

4. For full documentation:
   - README.md - Installation and access instructions
   - charts/korap/VALUES.md - Configuration reference
   - IMPLEMENTATION.md - Architecture and troubleshooting