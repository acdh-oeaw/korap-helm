profile: lite

global:
  imagePullPolicy: IfNotPresent

service:
  kalamar:
    port: 64543
    type: ClusterIP
  kustvakt:
    port: 8089
    type: ClusterIP

kalamar:
  image: korap/kalamar:latest
  replicaCount: 1
  extraEnv: []

kalamarFull:
  enabled: false
  image: korap/kalamar:latest
  replicaCount: 1
  extraEnv: []

kustvakt:
  image: korap/kustvakt:latest
  extraEnv: []

kustvaktFull:
  enabled: false
  image: korap/kustvakt:latest-full
  extraEnv: []

exampleIndex:
  enabled: false
  image: korap/example-index:0.1

indexVolume:
  size: 10Gi
  storageClassName: null
  existingClaim: null

ingress:
  enabled: false
  className: null
  annotations: {}
  hosts: []
  tls: []

full:
  enabled: false
  # OAuth2 Super Client Configuration
  # If superClientInfoSecretName is empty, a Secret will be auto-generated from the configuration below
  # You can also provide your own pre-existing secret by setting superClientInfoSecretName
  superClientInfoSecretName: null
  superClientInfoKey: super_client_info
  superClientInfoPath: /kalamar/super_client_info
  
  superClientInfo:
    # Auto-generate OAuth2 super_client_info Secret with these values
    # Leave empty/null to disable authentication
    enabled: true
    clientId: "korap-client"
    clientSecret: "auto-generate"  # Set to "auto-generate" for secure random secret, or provide your own
    clientName: "KorAP"
    clientType: "CONFIDENTIAL"
    clientDescription: "KorAP Kalamar Frontend"
    clientUrl: "http://localhost:64543"
    clientRedirectUri: "http://localhost:64543/oauth2/callback"
    super: true
    refreshTokenExpiry: 31536000
    permitted: true
  
  kalamarProductionConf:
    enabled: false
    # Kalamar production configuration in Perl format
    # See: https://github.com/KorAP/Kalamar
    # Required format is a Perl hash configuration with API endpoint and plugin settings
    content: |
      {
        Kalamar => {
          api_path => 'https://korap.ids-mannheim.de/api/',
          api_version => '1.0',
          https_only => 1,
          plugins => ['Auth', 'KorAPXML2Krill', 'Tei2KorAPXML', 'Plugins']
        },
        'Kalamar-Auth' => {
          oauth2 => 1
        },
        CSP => {
          'default-src' => 'self',
          'style-src' => ['self','unsafe-inline'],
          'script-src' => ['self'],
          'connect-src' => 'self',
          'img-src' => ['self', 'data:']
        }
      }

  # LDAP Configuration for Kustvakt (Full Profile)
  kustvaktLdap:
    enabled: false
    # LDAP Server Details
    host: "ldap.example.com"
    port: 389
    useSSL: false
    useStartTLS: false
    
    # LDAP Search Configuration
    searchBase: "ou=users,dc=example,dc=com"
    searchFilter: "uid=${login}"
    
    # LDAP Admin Credentials
    sLoginDN: "cn=admin,dc=example,dc=com"
    # Password stored separately in secret
    passwordSecret: ldap         # Kubernetes secret name containing LDAP password
    password: null                # Optional: plain password to auto-create a Secret (not recommended in production)
    passwordKey: "password"       # Key in secret containing the password
    
    # Optional LDAP Settings
    emailAttribute: "mail"
    authFilter: "(uid=${login})"
    userNotBlockedFilter: null
    ldapTimeout: 9000
    trustStore: null
    
  dataVolume:
    enabled: false
    mountPath: /kalamar/data
    size: 50Gi
    storageClassName: null
    existingClaim: null
  kustvaktDataVolume:
    enabled: false
    mountPath: /kustvakt/data
    size: 50Gi
    storageClassName: null
    existingClaim: null

restartPolicy: Always

securityContext:
  runAsUser: 0
  runAsGroup: 0
  fsGroup: 0
